2005-07-07  Wu Yongwei  <adah@sh163.net>

	* doc/README: Update information about mem_pool_base.

2005-07-02  Wu Yongwei  <adah@sh163.net>

	* doc/README: Add URLs for the articles on debug_new and
	static_mem_pool.

2005-06-30  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (print_position_from_addr): Cache the last
	result to reduce the times to execute addr2line (starting a new
	process can be expensive, especially on Windows).

2005-06-29  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (operator new(size_t, const std::nothrow_t&)):
	Take advantage of _DEBUG_NEW_CALLER_ADDRESS (it should have been
	done earlier but somehow I missed it).
	(operator new[](size_t, const std::nothrow_t&)): Ditto.

2005-06-29  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_mem_pool.cpp
	(static_mem_pool_set::~static_mem_pool_set): Remove the unnecessary
	mutex lock (which will require _FAST_MUTEX_CHECK_INITIALIZATION to
	be non-zero).

2005-06-29  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_mem_pool.h (static_mem_pool_set): Change the incorrect
	private inheritance from class_level_lock<static_mem_pool_set> into
	a more consistent typedef.

2005-06-13  Wu Yongwei  <adah@sh163.net>

	* misc/Doxyfile (INPUT): Add fixed_mem_pool.h.
	(PROJECT_NUMBER): Increase to 0.5.
	* misc/release.bat (VER): Ditto.
	* misc/release.sh (VER): Ditto.

2005-06-13  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_mem_pool.h: Trivially adjust the #include order.
	(static_mem_pool_set): Change the public inheritance from
	class_level_lock<static_mem_pool_set> into the default private
	inheritance.

2005-06-11  Wu Yongwei  <adah@sh163.net>

	* nvwa/class_level_lock.h (class_level_lock<>::lock): Add empty
	default constructor to avoid `unused' warnings under some compilers.

2005-06-11  Wu Yongwei  <adah@sh163.net>

	* nvwa/fixed_mem_pool.h (fixed_mem_pool<>): Change the private
	inheritance into a typedef to avoid warnings and errors under some
	compilers.

2005-06-10  Wu Yongwei  <adah@sh163.net>

	* nvwa/fixed_mem_pool.h (fixed_mem_pool<>): Privately inherit from
	class_level_lock to use the its nested type lock.
	(fixed_mem_pool<>::_S_first_avail_ptr): Add the __VOLATILE modifier.
	(fixed_mem_pool<>::_S_alloc_cnt): Ditto.
	(fixed_mem_pool<>::allocate): Use type lock for synchronization.
	(fixed_mem_pool<>::deallocate): Ditto.
	(fixed_mem_pool<>::deinitialize): Add an assertion.

2005-06-09  Wu Yongwei  <adah@sh163.net>

	* doc/README: Add description of fixed_mem_pool.h.

2005-06-08  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_mem_pool.h (PREPARE_MEMORY_POOL): Change to
	PREPARE_STATIC_MEM_POOL.
	(PREPARE_MEMORY_POOL_GROUPED): Change to
	PREPARE_STATIC_MEM_POOL_GROUPED.

2005-05-06  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp: Update copyright year.
	* nvwa/debug_new.h: Ditto.
	* nvwa/fast_mutex.h: Ditto.
	* nvwa/fixed_mem_pool.h: Ditto.
	* nvwa/static_mem_pool.h: Ditto.

2005-05-03  Wu Yongwei  <adah@sh163.net>

	* nvwa/fixed_mem_pool.h: New file.

2005-05-02  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_mem_pool.h (static_mem_pool<>::static_mem_pool):
	Change a variable name so that it is consistent with other names.

2005-03-20  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp: Adjust the doc comment: unify the expression
	of double-quote literals on the command line; and italicize the
	words `bash' and `ksh'.

2005-03-08  Wu Yongwei  <adah@sh163.net>

	* nvwa/fast_mutex.h (_PTHREADS): Undef if _WIN32THREADS is also
	defined.
	* nvwa/static_mem_pool.h (DECLARE_STATIC_MEM_POOL,
	DECLARE_STATIC_MEM_POOL_GROUPED): Reorganize code to avoid a (false)
	warning from some compilers.

2005-01-28  Wu Yongwei  <adah@sh163.net>

	* doc/README: Rephrase the paragraph about `GLIBCPP_FORCE_NEW'.

2005-01-16  Wu Yongwei  <adah@sh163.net>

	* misc/Doxyfile (PROJECT_NUMBER): Increase to 0.4.
	* misc/release.bat (VER): Ditto.
	* misc/release.sh (VER): Ditto.

2005-01-16  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (__debug_new_counter::~__debug_new_counter):
	Print a warning if GCC 3 or later is detected but no appropriate
	enviroment variable is set.

2005-01-04  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (print_position_from_addr): New static function.
	(print_position): Change the addr2line logic to a function call.

2005-01-02  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp: Hard-remove and re-add the revisions since 20
	December since I wrongly bumped the revision number.
	* nvwa/debug_new.h: Ditto.
	* nvwa/static_assert: Ditto.

2004-12-28  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_assert.h: New file.
	* nvwa/debug_new.cpp: Use static_assert.

2004-12-25  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (new_ptr_list_t): Add an anonymous union with a
	new member addr.
	(free_pointer): Eliminate a cast with the new union member addr.
	(check_leaks): Ditto.
	(operator new(size_t, const char*, int)): Ditto.

2004-12-25  Wu Yongwei  <adah@sh163.net>

	* misc/Doxyfile (EXPAND_ONLY_PREDEF): Set to `YES'.
	(EXPAND_AS_DEFINED): Add `__PRIVATE'.
	* misc/doxit.sh: Make refman.ps only when `ps' is specified on the
	command line.

2004-12-24  Wu Yongwei  <adah@sh163.net>
	* nvwa/debug_new.h: Add the new[](size_t) declaration required by
	MSVC 6 and enclose by macro conditionals.

2004-12-24  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (_DEBUG_NEW_ALIGNMENT): New macro.
	(align): New internal function-like macro.
	(aligned_list_item_size): New constant.
	(search_pointer): Use aligned_list_item_size.
	(free_pointer): Ditto.
	(check_leaks): Ditto.
	(operator new(size_t, const char*, int)): Ditto.

2004-12-22  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (_DEBUG_NEW_HASH): Eliminate cast warnings on
	64-bit platforms.

2004-12-20  Wu Yongwei  <adah@sh163.net>

	* doc/README: Add a note about new features of debug_new.

2004-12-20  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.h: Increase the version number to 3.0.
	* nvwa/debug_new.cpp: Ditto.
	Add a documentation comment.

2004-12-19  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (check_leaks, free_pointer): Fix the bug that
	the address of a new[] caller cannot be converted correctly.

2004-12-18  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp: Add more documentation comment about new usage.
	(print_position): Replace a strcat call with a strcpy call.
	(operator new(size_t, const std::nothrow_t&),
	operator new[](size_t, const std::nothrow_t&)): Do not define if a
	Borland C++ compiler no later than 5.5.1 is detected.

2004-12-18  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (new_output_lock): New static variable.
	(free_pointer): Use new_output_lock to synchronize output to
	new_output_fp.
	(check_leaks): Ditto.
	(operator new(size_t, const char*, int)): Ditto.
	(operator delete(void*)): Ditto.
	(operator delete[](void*)): Ditto.
	(operator delete(size_t, const char*, int)): Ditto.
	(operator delete[](size_t, const char*, int)): Ditto.

2004-12-12  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (_DEBUG_NEW_CALLER_ADDRESS): New macro.
	(_DEBUG_NEW_PROGNAME): New macro.
	(_DEBUG_NEW_USE_ADDR2LINE): New macro.
	(new_progname): New global variable.
	(print_position): New static function.
	(free_pointer): Change the interface to pass the caller address (and
	display caller information when needed).
	(check_leaks): Call print_position to display caller information.
	(operator new(size_t, const char*, int)): Ditto.
	(operator delete(void*)): Ditto.
	(operator delete[](void*)): Ditto.
	(operator delete(size_t, const char*, int)): Ditto.
	(operator delete[](size_t, const char*, int)): Ditto.
	(operator new(size_t)): Take advantage of _DEBUG_NEW_CALLER_ADDRESS.
	(operator new[](size_t)): Ditto.
	(operator delete(void*)): Ditto.
	(operator delete[](void*)): Ditto.
	(operator delete(void*, const std::nothrow_t&)): Ditto.
	(operator delete[](void*, const std::nothrow_t&)): Ditto.
	(free_pointer): Call fflush before _DEBUG_NEW_ERROR_ACTION.
	(operator new(size_t, const char*, int)): Ditto.
	(operator delete(void*)): Ditto.
	(operator delete[](void*)): Ditto.
	* nvwa/debug_new.h: Add declaration of new_progname.
	* misc/Doxyfile: Predefine __GNUC__ in doxygen documentation.

2004-12-09  Wu Yongwei  <adah@sh163.net>

	* doc/README: Make minor editorial changes.

2004-12-09  Wu Yongwei  <adah@sh163.net>

	* misc: New directory.
	* misc/Doxyfile: New file.
	* misc/doxit.sh: New file.
	* misc/doxygen.css: New file.
	* misc/release.bat: New file.
	* misc/release.sh: New file.

2004-12-09  Wu Yongwei  <adah@sh163.net>

	* doc/README: Change the layout to make it easier to read.

2004-12-08  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (_DEBUG_NEW_ERROR_ACTION): New macro.
	(free_pointer): Use the new macro when errors occur.
	(operator new(size_t, const char*, int)): Ditto.
	(operator delete(void*)): Ditto.
	(operator delete[](void*)): Ditto.

2004-11-17  Wu Yongwei  <adah@sh163.net>

	* nvwa/cont_ptr_utils.h: Add documentation comment.

2004-11-10  Wu Yongwei  <adah@sh163.net>

	* nvwa/cont_ptr_utils.h (output_object<>): New functor template to
	help output the objects pointed by a container of pointers to a
	stream.

2004-09-23  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_mem_pool.h: Remove " != NULL" in conditionals for
	consistency.
	(DECLARE_STATIC_MEM_POOL, DECLARE_STATIC_MEM_POOL_GROUPED): Change
	instance to instance_known in definition of operator delete, since
	the instance should be created in a prior call to operator new.

2004-08-17  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_mem_pool.h (static_mem_pool<>::_S_instance_p): Add
	`__VOLATILE'.
	(static_mem_pool<>::_S_create_instance): Fix the object creation a
	little (still uses DCLP and still unsafe on some multiprocessor
	systems).
	(static_mem_pool<>::instance): Add a caution comment on DCLP.

2004-08-07  Wu Yongwei  <adah@sh163.net>

	* nvwa/bool_array.h: Add more documentation comment.
	* nvwa/bool_array.cpp: Ditto.
	(bool_array::count(unsigned long, unsigned long)): Change the call
	interface to an STL-like range.

2004-08-04  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (search_pointer): New static function.
	(free_pointer): New static function.
	(check_leaks): Leave out highest bit when displaying line number.
	(operator new(size_t, const char*, int)): Add an assertion.
	(operator new[](size_t, const char*, int)): Set highest bit of line
	number.
	(operator new[](size_t)): Implement with operator new[](size_t,
	const char*, int).
	(operator delete(void*)): Implement with search_pointer and
	free_pointer.
	(operator delete[](void*)): Ditto.
	(operator delete[](void*, const char*, int)): Implement with
	delete[](void*).
	(operator delete[](void*, const std::nothrow_t&)): Ditto.

2004-08-04  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp: Disable two warnings emitted by MSVC 7.1.

2004-08-02  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp: Correct the wrong name in the doxygen file tag.
	* nvwa/debug_new.h: Correct the misuse of `<' literal in doc comment.
	* nvwa/pctimer.h: Add the missing comma in the doxygen version tag.

2004-07-26  Wu Yongwei  <adah@sh163.net>

	* nvwa/class_level_lock.h: Add a full stop after the file briefing
	to make it work better with doxygen.
	* nvwa/cont_ptr_utils.h: Ditto.
	* nvwa/debug_new.cpp: Ditto.
	* nvwa/debug_new.h: Ditto.
	* nvwa/fast_mutex.h: Ditto.
	* nvwa/mem_pool_base.cpp: Ditto.
	* nvwa/mem_pool_base.h: Ditto.
	* nvwa/pctimer.h: Ditto.
	* nvwa/set_assign.h: Ditto.
	* nvwa/static_mem_pool.cpp: Ditto.
	* nvwa/static_mem_pool.h: Ditto.

2004-07-10  Wu Yongwei  <adah@sh163.net>

	* doc/README: Add note about GLIBCPP_FORCE_NEW/GLIBCXX_FORCE_NEW.

2004-06-25  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (check_leaks): Change `cLeaked' to `leak_cnt'
	for consistency.
	* nvwa/debug_new.cpp: Add more documentation comment.
	* nvwa/debug_new.h: Ditto.

2004-06-15  Wu Yongwei  <adah@sh163.net>

	* doc/README: New file.

2004-06-01  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.cpp (total_mem_alloc): New static variable.
	(operator new): Add bytes of allocated memory to total_mem_alloc.
	(operator delete): Subtract bytes of deallocated memory from
	total_mem_alloc and display total_mem_alloc when verbose flag is on.

2004-05-09  Wu Yongwei  <adah@sh163.net>

	* nvwa/bool_array.h: New file.
	* nvwa/bool_array.cpp: New file.

2004-05-09  Wu Yongwei  <adah@sh163.net>

	* nvwa/object_level_lock.h: Add some comments explaining its motive.

2004-04-20  Wu Yongwei  <adah@sh163.net>

	* nvwa/debug_new.h: Add exception specifications to make it compile
	under stricter compilers and the `-pedantic' option of GCC.
	* nvwa/debug_new.cpp: Ditto.

2004-04-15  Wu Yongwei  <adah@sh163.net>

	* nvwa/cont_ptr_utils.h: New file.
	* nvwa/static_mem_pool.h: Prefix an underline to macros
	STATIC_MEM_POOL_DEBUG and STATIC_MEM_POOL_TRACE.
	(static_mem_pool_set::add): Remove inline implementation.
	(static_mem_pool_set::remove): Remove.
	(static_mem_pool<>::static_mem_pool): Move out code to insert itself
	into static_mem_pool_set.
	(static_mem_pool<>::~static_mem_pool): Move out code to remove
	itself from static_mem_pool_set.  Fix trace code for locking.
	(static_mem_pool<>::_S_create_instance): Move in code to add the new
	instance into static_mem_pool_set.
	* nvwa/static_mem_pool.cpp: Prefix an underline to macro
	STATIC_MEM_POOL_TRACE.
	(static_mem_pool_set::~static_mem_pool_set): Use a more natural way
	to remove all instances of static_mem_pool.
	(static_mem_pool_set::add): Move implementation here.  Remove the
	trace message of adding a static_mem_pool.
	* nvwa/debug_new.h: Prefix an underline to file-specific macros.
	* nvwa/debug_new.cpp: Ditto.
	* nvwa/mem_pool_base.cpp: Ditto.

2004-04-11  Wu Yongwei  <adah@sh163.net>

	* nvwa/class_level_lock.h (class_level_lock<>): Add parameter
	_RealLock.
	(class_level_lock<>::lock::lock): Remove parameter __lock.
	(class_level_lock<>::lock::acquire): Remove.
	(class_level_lock<>::lock::release): Remove.
	(class_level_lock<_Host, false>): Add optional partial specialization.
	* nvwa/static_mem_pool.h: Synchronize with the above interface change.
	(static_mem_pool): Remove the unnecessary inheritance from
	class_level_lock.

2004-04-06  Wu Yongwei  <adah@sh163.net>

	* nvwa/pctimer.h: New file.
	* nvwa/set_assign.h: New file.

2004-04-03  Wu Yongwei  <adah@sh163.net>

	* nvwa/static_mem_pool.cpp (static_mem_pool_set::~static_mem_pool_set):
	Remove the use of manual mutex acquire/release.
	* nvwa/static_mem_pool.h (static_mem_pool<>::allocate): Ditto.
	(static_mem_pool<>::_S_instance_p): Remove __VOLATILE.

2004-03-30  Wu Yongwei  <adah@sh163.net>

	* nvwa/memory_pool.h: Remove (reorganized into the new files).
	* nvwa/memory_pool.cpp: Ditto.
	* nvwa/mem_pool_base.h: New file.
	* nvwa/mem_pool_base.cpp: New file.
	* nvwa/static_mem_pool.h: New file.
	* nvwa/static_mem_pool.cpp: New file.

2004-03-28  Wu Yongwei  <adah@sh163.net>

	* nvwa/class_level_lock.h: New file, required by memory_pool.h.
	* nvwa/object_level_lock.h: New file.

2004-03-28  Wu Yongwei  <adah@sh163.net>

	* nvwa/memory_pool.h: New file.
	* nvwa/memory_pool.cpp: New file.

2004-03-26  Wu Yongwei  <adah@sh163.net>

	* nvwa/fast_mutex.h: Wrap #error messages in quotes.
	(_FAST_MUTEX_CHECK_INITIALIZATION): Set default to 1.
	* nvwa/debug_new.cpp (check_leaks): Remove the restriction that no
	new/delete could occur during check_leaks.

2004-03-23  Wu Yongwei  <adah@sh163.net>

	* nvwa/fast_mutex.h: New file.
	* nvwa/debug_new.h: New file.
	* nvwa/debug_new.cpp: New file.

2004-03-23  Wu Yongwei  <adah@sh163.net>

	Create new directory structure
	* nvwa: New directory.
	* doc: New directory.
